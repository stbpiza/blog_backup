![](https://velog.velcdn.com/images/stbpiza/post/406b7f70-b254-4c07-8434-9c3b964955f4/image.png)

# 4월 17일 ~ 4월 23일 주간회고

## 잡담

월요일엔 늦게까지 야근이 있었다.
금요일에도 공부 할 계획이었으나, 너무 피곤해서 잠들어버렸다

토요일에 열심히 해서 채워보려 했지만 그래도 부족했다.
열심히 하기로 마음먹은 만큼 힘들어도 더 열심히 해봐야겠다

## 업무 회고

### 구매 구현

재화로 상품을 구매할 수 있는 기능을 추가하기로 했다.

DB 테이블부터 만들었어야 했는데,

나중에 신규 기능 추가를 고려해서 확장성 있게 설계하려다 보니깐 생각보다 오래걸렸다.

그리고 구매같은 경우 DB lock을 걸어서 구현해야했는데,

lock을 처음 써봐서 적용에 오래걸렸다.

일단 적용은 잘 시켜놨는데, 날잡고 lock에 대해 학습해서 잘못한 부분이 없는지 점검해야겠다.

### 메모리 이슈

메모리 부족 이슈의 원인을 해결했다

메인 화면에 불러오는 데이터가 너무 많았어서 단건 api도 조회 못하고 메모리 부족이 발생했었는데,

그 원인은 “Entity 연관관계를 정확하게 설정해주지 않아서” 였다.

A table과 B table을 다대다로 매핑해주는 중간 table이 있었는데,

Entity 연관 관계에서 A에서 바로 B로 매핑해놨었고,

다대다 매핑 Entity에 soft delete WHERE 절을 자동으로 입력하도록 설정한 부분이

동작하지 않았던 것이다.

그래서 soft delete 했던 내역들까지 전부 조회하고 있었고, 한 건에 5만건 이상 조회하고 있었다.

연관관계를 다시 매핑해주고, WHERE 절이 잘 들어가는걸 확인하니 조회 row가 100건 이하로 크게 감소했다.


그리고 또다른 api에서도 문제를 찾았는데,

게시물 좋아요, 저장한 유저까지 Fetch Join으로 한 번에 불러오다보니 조회 row가 너무 많아졌다.

Fetch Join으로 모든 좋아요 유저 리스트를 불러서 내가 있는지를 서버단에서 찾았었는데,

별도의 쿼리로 분리하고, 모든 유저 리스트가 아닌 나만 검색해서 조회하는 방식으로 수정했다.

6만건씩 조회하던 로직이 10건 이하로 크게 감소했고, 메모리 문제도 해결됐다.


## 학습 회고

이번주에는 REST에 대해 학습했다.
명확히 REST에 알진 못했지만 적당히 아는만큼 사용하고 있었는데,
REST에 대해 더 알 수 있게 되었다.

사실은 아직도 완전히 이해했다고 볼 수는 없지만 더 학습해서 부족한 부분을 채울 것이다.

### API

거의 매일 사용하는 용어지만 설명하라고 한다면 명확하게 대답하긴 어려웠다.
우리가 만든 기능을 사용하기 위한 설명서? 정도로 대답했을 것 같다.

지금은 “소프트웨어 인터페이스로 두 소프트웨어가 서로 통신할 수 있게 정한 규칙이다.
인터페이스이기 때문에내부 구현 로직은 숨기고 사용 방법만 노출시키며, 일반적으로 HTTP 웹 서버로 제공하고 JSON이나 XML을 사용해 요청-응답 메세지 시스템으로 정의되어 있다.” 라고 대답하겠다.


### REST

REST 제약조건에 대해 학습했고, 우리는 모든 제약조건을 지키지 않고 많이 사용한다는 사실을 알았다.

기존 HTML을 응답해주는 웹의 경우 REST 조건을 충족시키기 좋지만,

JSON을 많이 사용하는 API의 경우에는 모든 제약조건을 다 충족시키기는 불편하다는 걸 배웠다.

결국 REST 제약조건을 반드시 지킬 필요는 없지만 알고 있으면 좋으며,

사람들이 많이 사용하는 규칙대로 API를 만들어야 확장성에도 용이하고

개발자들끼리 협업하기 좋다는걸 깨달았다.

### MIME type

생각보다 MIME type 종류가 엄청 많았다.

언젠가 나도 IANA에 새로운 속성을 등록할 일이 있을까 하는 생각을 해봤다.

### Collection Pattern

기존에 API 만들때도 어느정도 규칙에 맞게 작성하고 있었다.

다만 좀 더 명확한 가이드라인을 배우게 되어서 좋았고

다른 개발자들과 협업할 때 잘 활용할 수 있겠다고 생각했다.

## 마무리

다음주에는 더 열심히 하자!